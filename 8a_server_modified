"""
This is a Flask server that hosts the emotion detector.
"""

from flask import Flask, request, jsonify, render_template
from src.EmotionDetection import emotion_detector

app = Flask(__name__)


@app.route("/")
def home():
    """
    home route to display page to submit text for emotion detection
    """
    return render_template("index.html")


@app.route("/emotionDetector", methods=["GET", "POST"])
def detect_emotion():
    """
    detect emotion of given text

    Args:
        textToAnalyze: text to analyse

    Returns:
        emotion scores and dominant emotion
    """
    text = request.args.get("textToAnalyze")

    if not text:
        return jsonify({"error": "No Text Provided"}), 400

    result = emotion_detector(text)

    return jsonify(result)


if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000, debug=True)
